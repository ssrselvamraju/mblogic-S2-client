<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
	"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>Help - Alarm and Event History</title>

<link rel="icon" type="image/png" href="/systemicon.png">
<!-- General page layout style sheet. -->
<link rel="stylesheet" href="/helppagelayout.css" type="text/css">
</head>

<body>
<div id="filler">

	<div id="header">
		<p class="headlogo">
			<img src="/systemlogo.png" width="200" alt="MB Logic Logo"/>
			<span class="headtitle1">MBLogic </span>
			<span class="headtitle2"> for an open world in automation</span>
		</p>
	</div>

	<!-- This is the standard nav bar. -->
	<div id="nav">
		<ul>
			<li><a href="/statussystem.html">Home</a></li>
			<li><a href="/statuspages/statusconfigure.html">Configure</a></li>
			<li><a href="/statuspages/statuscontrol.html">Control</a></li>
			<li><a href="/statuspages/statusmonitor.html">Monitor Data</a></li>
			<li><a href="/statuspages/statussysmon.html">System</a></li>
			<li><a href="/statuspages/statusxref.html">XRef</a></li>
			<li><a href="/helpmain.html">Help</a></li>
		</ul>
	</div>



<hr>

	<!-- This is the help system nav bar. -->
	<div id="helpnav">
		<h2>Help Topics</h2>
		<ul>
			<li><a href="/helpmain.html">Help</a></li>
			<li><a href="/general/General-en.html">General</a></li>
			<li><a href="/statushelp/MBStatusHelp.html">System Status</a></li>
			<li><a href="/communications/ComsIntro-en.html">Communications</a></li>
			<li><a href="/softlogic/SLIntro-en.html">Soft Logic</a></li>
			<li><a href="/hmi/HMIIntro-en.html">HMI</a></li>
			<li><a href="/installation/InstallIntro-en.html">Installation</a></li>
			<li><a href="/general/About-en.html">About</a></li>
		</ul>

		<h3>Topic Details for HMI</h3>
		<ul>
			<li><a href="/hmi/hmiconfig-en.html">HMI Server Configuration</a></li>
			<li><a href="/hmi/alarmhistory-en.html">Alarm and Event History</a></li>
			<li><a href="/hmi/hmibuilder/hmibuilder.html">MBLogic HMIBuilder</a></li>
			<li><a href="/hmi/hmilib/hmilib.html">HMI Javascript Client Libraries</a></li>
			<li><a href="/hmi/basicconcepts/basicconcepts.html">Basic Concepts</a></li>
		</ul>

	</div>




<div id="datadisplay">

<h1>Help - Alarm and Event History</h1>

<hr>

<h2>Overview</h2>

<p>The alarm and event history database can be queried via the provided web
based history query system. Most of the help information presented here is 
also in the alarm and event history page itself under the "help" tab.
</p>

<hr>

<h2>Accessing the Alarm and Event History Page.</h2>

<p>The alarm and event history page is part of the HMI system and is accessed
via the same URL as the HMI web pages. This means the HMI server must be 
configured and running to access the history system. The history system can 
also operate via the read-only restricted HMI service.     
</p>

<p>The history web page will be listed as one of the "HMI Web Pages" on the
"System Configure" web page in the status system. With the default 
configuration provided with the system, the history web page can be accessed
directly via the following URL:
</p>

<pre class="examples">

	http://localhost:8082/history-en.html

</pre>

<p>You may need to change the IP number ("localhost" in this example) or port 
(8082 in this example) depending on how you have installed the system. 
</p>

<hr>

<h2>Event History</h2>

<p>The event database can be queried for events by date, by event name, or by 
a combination of the two. Select the query method you wish to use by selecting 
the appropriate check box.
</p>

<p>
<img src="eventhistoryquery.png" width="550" alt="Event history">
</p>


<h3>Querying Events by Date</h3>

<p>To query events by date, enter the desired date range in the date form. The 
resulting query will fetch events which occured between (and including) those 
two dates. Pressing the "reset" button will reset the date range to the 
default values.
</p>

<h3>Querying Events by Event Name</h3>


<p>To query events by event name, select the desire events from the drop down 
selection widget. Each time you select an event, it will be added to the 
query and you will see it listed below the selection widget. To clear the 
current selection, press the "reset" button.
</p>

<p>When you select multiple events, the request is "OR"ed together. That is, 
the query match record which contain any of the events requested.
</p>

<h3>Querying by Both Date and Event Name</h3>

<p>You can query by a combination of both date and event name by selecting 
both options at once. This will select records which are both within the 
requested date range and which contain the requested events.
</p>

<h3>Starting the Query</h3>

<p>Once you have specified the search criteria, press the "Get Events" button. 
This will send the request to the system and display the results when they 
are returned. The results will be displayed in the table beneath the "Get 
Events" button. The results will show the date at which the event occured, 
and the name of the event.
</p>

<hr>

<h2>Alarm History Query</h2>

<p>The alarm history database can be queried for events by date, by alarm name, 
by count, or by a combination of any two or three these. Select the query 
method you wish to use by selecting the appropriate check box.
</p>

<p>
<img src="alarmhistoryquery.png" width="550" alt="Alarm history">
</p>

<h3>Querying Alarm History by Date</h3>

<p>To query alarm history by date, enter the desired date range in the date 
form. The resulting query will fetch alarms which occured between (and 
including) those two dates. Pressing the "reset" button will reset the date 
range to the default values.
</p>

<h3>Querying Alarm History by Alarm Name</h3>

<p>To query alarm history by alarm name, select the desire alarms from the 
drop down selection widget. Each time you select an alarm, it will be added 
to the query and you will see it listed below the selection widget. To clear 
the current selection, press the "reset" button.
</p>

<p>When you select multiple alarms, the request is "OR"ed together. That is, 
the query match record which contain any of the alarms requested.
</p>

<h3>Querying Alarm History by Count</h3>

<p>To query alarm history by count (the number of times the alarm occurred 
before being sent to the history), enter the desired count range in the count 
form. The resulting query will fetch alarms which occured between (and 
including) those two count ranges.
</p>

<h3>Querying by Multiple Criteria</h3>

<p>You can query by any combination of date, alarm name, and count by 
selecting multiple options at once. This will select records which meet all 
the selected criteria. Criteria which are not selected will not factor in the 
search.
</p>

<h3>Starting the Query</h3>

<p>Once you have specified the search criteria, press the "Get Alarms" button. 
This will send the request to the system and display the results when they 
are returned. The results will be displayed in the table beneath the "Get 
Alarms" button. The results will show the following:
</p>

<ul>
	<li>The date at which the alarm originally occurred.</li>
	<li>The date at which the alarm became "ok".</li>
	<li>The name of the alarm.</li>
	<li>The name of the client which acknowldged the alarm.</li>
	<li>The number of times the alarm occurred before being sent to history.</li>
</ul>

<hr>


<h2>Alarm and Event Messages</h2>

<p>The alarm and event history must be integrated with the HMI application
in order to use the same alarm and event messages. These messages are read
from a file. The default name for this file is 
<strong><em>messagetexts.js</em></strong>. 
The alarm texts are in an object called 
<strong><em>MBT_AlarmText</em></strong>.
The event texts are in an object called 
<strong><em>MBT_EventText</em></strong>.
</p>

<pre class="examples">

	MBT_AlarmText = {
	"PB1Alarm" : "PB1 was pressed.",
	"PB2Alarm" : "PB2 was pressed.",
	"PB3Alarm" : "PB3 was pressed.",
	"PB4Alarm" : "PB4 was pressed."
	};

	MBT_EventText = {
	"PumpRunning" : "Tank pump is running.",
	"PumpStopped" : "Tank pump is stopped.",
	"Tank1Empty" : "Tank 1 is empty.",
	"Tank1Full" : "Tank 1 is full.",
	"Tank2Empty" : "Tank 2 is empty.",
	"Tank2Full" : "Tank 2 is full."
	};

</pre>

<p>If your HMI application uses a different file to store the messages,
or different object names, you will need to change the alarm and event history
web page accordingly. 
</p>


<hr>

<h2>System Components</h2>

<p>The alarm and event history system draws its data from the alarm and event
database. Alarm and event logging is described elsewhere in this documentation
and so is not covered in any more detail here.
</p>

<p>The alarm and event history reporting system consists of the following
components:
</p>

<ul>
	<li><strong>history-en.html</strong> - This is a web application contained 
		in a web page. This page can be renamed if desired.</li>
	<li><strong>history.css</strong> - This is a text file which contains 
		information about styles such as colours, fonts, text sizes, etc. This 
		is a standard web page style sheet and information about it can be
		found in any reference about creating web pages. </li>
	<li><strong>pagebackground.png</strong> - This is an image file which
		provides a page background.</li>
	<li><strong>pageicon.png</strong> - This is an image file which provides
		a web page icon. </li>
	<li><strong>pagelogo.png</strong> - This is an image file which provides
		a web page image. </li>
	<li><strong>Messages</strong> - These are the actual message texts which
		convert the alarm and event "tags" to readable messages. See the above
		section on "Alarm and Event Messages" for more information.</li>
	<li><strong>Javascript libraries</strong> - These are files containing
		Javascript code which run the alarm and event history web page 
		application These are <em>libhistory.js</em> and <em>libdata.js</em>.
		</li>
</ul>

<p>With the exception of the Javascript libraries, all history components must
be located in the <em>hmipages</em> directory so they can be served by the
HMI web server. The Javascript library files are located with the other 
standard HMI Javascript libraries in another directly within the system 
software. 
</p>


<hr>

<h2>Customising the Alarm and Event History</h2>

<p>The alarm and event history page has various page decorations which can
be changed to match the desired theme or appearance of the control application.
They can be changed by editing the web page with a text editor. These consist 
of the following:  
</p>

<ul>
	<li>Logo</li>
	<li>Page Icon</li>
	<li>Background</li>
	<li>Page Heading</li>
</ul>

<h3>Logo</h3>

<p>The logo is an image found at the top left of the page. The default logo 
used is called <strong><em>pagelogo.png</em></strong>. 
</p>

<h3>Icon</h3>

<p>The page icon is a small image which is used by various web browsers in
different ways. For example, with Firefox it appears in the page tab, as well
as to the left of the URL bar, and also in the bookmarks. The default icon used
is called <strong><em>pageicon.png</em></strong>.
</p>

<h3>Background Image</h3>

<p>The background image appears around the edges and at the bottom of the web 
page. The default background image used is called 
<strong><em>pagebackground.png</em></strong>. 
</p>

<p>The logo, page icon, and background image are the same files as used with
the HMI demo application. They can be changed to use different file names,   
different files with the same names can be substituted, or they can be removed
altogether. The logo and icon file names are specified in the HTML file, while 
the page background is specified in the CSS file. 
</p>

<h3>Page Heading</h3>

<p>The page heading is a text message which appears at the top of the page to
the right of the logo. This is located in the HTML file and can be changed to
suit the application. 
</p>

<h3>CSS Styles</h3>

<p>In addition to these, the CSS file can be modified to change the colours,
fonts, and other features. The HTML file itself can be changed as desired. 
</p>

<hr>


</div>


<!-- Standard footer -->
<div id="footer">
	<p>Help - Alarm and Event History</p>
</div>

</div>

</body>
</html>

<!-- Copyright 2010. Michael Griffin
This file is part of MBLogic.
MBLogic is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
MBLogic is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.
You should have received a copy of the GNU General Public License
along with MBLogic. If not, see <http://www.gnu.org/licenses/>.
 -->

